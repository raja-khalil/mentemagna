{% extends 'base.html' %}

{% set page_title = 'Pol√≠tica de Cookies - Mente Magna' %}
{% set page_description = 'Pol√≠tica de cookies do Mente Magna. Como utilizamos cookies para melhorar sua experi√™ncia.' %}
{% set breadcrumbs = [{'title': 'Pol√≠tica de Cookies'}] %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <article class="legal-document">
            <header class="mb-5">
                <h1 class="display-5 fw-bold text-warning">üç™ Pol√≠tica de Cookies</h1>
                <p class="lead text-muted">
                    √öltima atualiza√ß√£o: {{ moment().strftime('%d de %B de %Y') if moment else '20 de Junho de 2025' }}
                </p>
                <div class="alert alert-warning">
                    <strong>üîî Aviso:</strong> Este site utiliza cookies para melhorar sua experi√™ncia. 
                    Ao continuar navegando, voc√™ aceita nossa pol√≠tica de cookies.
                </div>
            </header>

            <!-- Painel de Configura√ß√£o de Cookies -->
            <section class="mb-5">
                <div class="card">
                    <div class="card-header bg-warning text-dark">
                        <h2 class="mb-0">‚öôÔ∏è Configura√ß√µes de Cookies</h2>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="essentialCookies" checked disabled>
                                    <label class="form-check-label" for="essentialCookies">
                                        <strong>Cookies Essenciais</strong><br>
                                        <small class="text-muted">Necess√°rios para o funcionamento b√°sico do site</small>
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="analyticsCookies">
                                    <label class="form-check-label" for="analyticsCookies">
                                        <strong>Cookies de Analytics</strong><br>
                                        <small class="text-muted">Google Analytics para melhorar o site</small>
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="advertisingCookies">
                                    <label class="form-check-label" for="advertisingCookies">
                                        <strong>Cookies de Publicidade</strong><br>
                                        <small class="text-muted">Google AdSense para an√∫ncios relevantes</small>
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="functionalCookies">
                                    <label class="form-check-label" for="functionalCookies">
                                        <strong>Cookies Funcionais</strong><br>
                                        <small class="text-muted">Lembrar prefer√™ncias e configura√ß√µes</small>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="mt-3">
                            <button type="button" class="btn btn-success me-2" onclick="saveCookiePreferences()">
                                ‚úÖ Salvar Prefer√™ncias
                            </button>
                            <button type="button" class="btn btn-primary me-2" onclick="acceptAllCookies()">
                                üç™ Aceitar Todos
                            </button>
                            <button type="button" class="btn btn-outline-danger" onclick="rejectAllCookies()">
                                ‚ùå Rejeitar Opcionais
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <div class="content">
                <section class="mb-4">
                    <h2>1. O que s√£o Cookies?</h2>
                    <p>
                        Cookies s√£o pequenos arquivos de texto armazenados no seu dispositivo 
                        quando voc√™ visita um site. Eles ajudam o site a lembrar informa√ß√µes 
                        sobre sua visita, tornando mais f√°cil visitar novamente e tornando o site mais √∫til.
                    </p>
                </section>

                <section class="mb-4">
                    <h2>2. Como Utilizamos Cookies</h2>
                    <p>O <strong>Mente Magna</strong> utiliza cookies para:</p>
                    <ul>
                        <li>Manter voc√™ logado (quando aplic√°vel)</li>
                        <li>Lembrar suas prefer√™ncias de configura√ß√£o</li>
                        <li>Analisar como voc√™ usa nosso site</li>
                        <li>Personalizar conte√∫do e an√∫ncios</li>
                        <li>Melhorar a seguran√ßa do site</li>
                    </ul>
                </section>

                <section class="mb-4">
                    <h2>3. Tipos de Cookies</h2>
                    
                    <h3>3.1 Cookies Essenciais</h3>
                    <p>Necess√°rios para o funcionamento b√°sico do site. N√£o podem ser desabilitados.</p>
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>Prop√≥sito</th>
                                    <th>Dura√ß√£o</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>session_id</td>
                                    <td>Identifica√ß√£o da sess√£o</td>
                                    <td>Sess√£o</td>
                                </tr>
                                <tr>
                                    <td>csrf_token</td>
                                    <td>Seguran√ßa contra ataques</td>
                                    <td>Sess√£o</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3>3.2 Cookies de Analytics</h3>
                    <p>Coletam informa√ß√µes sobre como voc√™ usa o site para nos ajudar a melhor√°-lo.</p>
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>Provedor</th>
                                    <th>Prop√≥sito</th>
                                    <th>Dura√ß√£o</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>_ga</td>
                                    <td>Google Analytics</td>
                                    <td>Identifica√ß√£o √∫nica do usu√°rio</td>
                                    <td>2 anos</td>
                                </tr>
                                <tr>
                                    <td>_ga_*</td>
                                    <td>Google Analytics</td>
                                    <td>Estado da sess√£o</td>
                                    <td>2 anos</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3>3.3 Cookies de Publicidade</h3>
                    <p>Utilizados para exibir an√∫ncios relevantes baseados em seus interesses.</p>
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>Provedor</th>
                                    <th>Prop√≥sito</th>
                                    <th>Dura√ß√£o</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>_gcl_au</td>
                                    <td>Google AdSense</td>
                                    <td>Convers√µes de an√∫ncios</td>
                                    <td>90 dias</td>
                                </tr>
                                <tr>
                                    <td>IDE</td>
                                    <td>Google</td>
                                    <td>Publicidade personalizada</td>
                                    <td>2 anos</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section class="mb-4">
                    <h2>4. Gerenciar Cookies</h2>
                    <p>Voc√™ pode controlar cookies de v√°rias maneiras:</p>
                    
                    <h3>4.1 Configura√ß√µes do Site</h3>
                    <p>Use o painel de configura√ß√µes acima para escolher quais tipos de cookies aceitar.</p>
                    
                    <h3>4.2 Configura√ß√µes do Navegador</h3>
                    <ul>
                        <li><strong>Chrome:</strong> Configura√ß√µes > Privacidade e seguran√ßa > Cookies</li>
                        <li><strong>Firefox:</strong> Prefer√™ncias > Privacidade e seguran√ßa</li>
                        <li><strong>Safari:</strong> Prefer√™ncias > Privacidade</li>
                        <li><strong>Edge:</strong> Configura√ß√µes > Privacidade</li>
                    </ul>
                </section>

                <section class="mb-4">
                    <h2>5. Cookies de Terceiros</h2>
                    <p>Alguns cookies s√£o definidos por servi√ßos terceirizados que aparecem em nossas p√°ginas:</p>
                    <ul>
                        <li><strong>Google Analytics:</strong> 
                            <a href="https://policies.google.com/privacy" target="_blank" class="text-primary">
                                Pol√≠tica de privacidade do Google
                            </a>
                        </li>
                        <li><strong>Google AdSense:</strong> 
                            <a href="https://policies.google.com/technologies/ads" target="_blank" class="text-primary">
                                Como o Google usa cookies em publicidade
                            </a>
                        </li>
                    </ul>
                </section>

                <section class="mb-4">
                    <h2>6. Impacto da Desabilita√ß√£o</h2>
                    <p>Se voc√™ desabilitar cookies:</p>
                    <ul>
                        <li>Algumas funcionalidades podem n√£o funcionar corretamente</li>
                        <li>Voc√™ pode precisar reinserir informa√ß√µes a cada visita</li>
                        <li>An√∫ncios podem ser menos relevantes</li>
                        <li>N√£o poderemos melhorar o site com base no seu uso</li>
                    </ul>
                </section>

                <section class="mb-4">
                    <h2>7. Atualiza√ß√µes</h2>
                    <p>
                        Esta pol√≠tica de cookies pode ser atualizada periodicamente para refletir 
                        mudan√ßas em nossos servi√ßos ou regulamenta√ß√µes. Recomendamos que voc√™ 
                        revise esta p√°gina ocasionalmente.
                    </p>
                </section>

                <section class="mb-4">
                    <h2>8. Contato</h2>
                    <p>
                        Para quest√µes sobre nossa pol√≠tica de cookies, entre em contato:
                    </p>
                    <ul>
                        <li><strong>Email:</strong> cookies@mentemagna.com</li>
                        <li><strong>Contato:</strong> 
                            <a href="{{ url_for('main.contato') }}" class="text-primary">
                                Formul√°rio de contato
                            </a>
                        </li>
                    </ul>
                </section>
            </div>

            <footer class="mt-5 pt-4 border-top">
                <div class="alert alert-info">
                    <strong>‚ÑπÔ∏è Status atual dos seus cookies:</strong>
                    <div id="cookieStatus" class="mt-2">
                        <span class="badge bg-secondary">Carregando...</span>
                    </div>
                </div>
                <div class="text-center">
                    <p class="text-muted">
                        <strong>Mente Magna</strong> - Portal de Tecnologia e Inova√ß√£o<br>
                        <small>Pol√≠tica atualizada em {{ moment().strftime('%d/%m/%Y') if moment else '20/06/2025' }}</small>
                    </p>
                </div>
            </footer>
        </article>
    </div>
</div>

<style>
.legal-document h2 {
    color: #ffc107;
    margin-top: 2rem;
    margin-bottom: 1rem;
    font-size: 1.4rem;
}

.legal-document h3 {
    color: #495057;
    margin-top: 1.5rem;
    margin-bottom: 0.8rem;
    font-size: 1.1rem;
}

.legal-document p {
    line-height: 1.8;
    text-align: justify;
    margin-bottom: 1rem;
}

.legal-document ul {
    line-height: 1.8;
    margin-bottom: 1rem;
}

.legal-document a {
    text-decoration: none;
}

.legal-document a:hover {
    text-decoration: underline;
}

.form-check-input:checked {
    background-color: #28a745;
    border-color: #28a745;
}
</style>

<script>
// Carregar prefer√™ncias de cookies
document.addEventListener('DOMContentLoaded', function() {
    loadCookiePreferences();
    updateCookieStatus();
});

function loadCookiePreferences() {
    const preferences = JSON.parse(localStorage.getItem('cookiePreferences') || '{}');
    
    document.getElementById('analyticsCookies').checked = preferences.analytics || false;
    document.getElementById('advertisingCookies').checked = preferences.advertising || false;
    document.getElementById('functionalCookies').checked = preferences.functional || false;
}

function saveCookiePreferences() {
    const preferences = {
        essential: true, // sempre true
        analytics: document.getElementById('analyticsCookies').checked,
        advertising: document.getElementById('advertisingCookies').checked,
        functional: document.getElementById('functionalCookies').checked,
        timestamp: new Date().toISOString()
    };
    
    localStorage.setItem('cookiePreferences', JSON.stringify(preferences));
    localStorage.setItem('cookieConsent', 'customized');
    
    // Aplicar prefer√™ncias
    applyCookiePreferences(preferences);
    
    alert('‚úÖ Suas prefer√™ncias de cookies foram salvas!');
    updateCookieStatus();
}

function acceptAllCookies() {
    document.getElementById('analyticsCookies').checked = true;
    document.getElementById('advertisingCookies').checked = true;
    document.getElementById('functionalCookies').checked = true;
    
    saveCookiePreferences();
}

function rejectAllCookies() {
    document.getElementById('analyticsCookies').checked = false;
    document.getElementById('advertisingCookies').checked = false;
    document.getElementById('functionalCookies').checked = false;
    
    saveCookiePreferences();
}

function applyCookiePreferences(preferences) {
    // Google Analytics
    if (preferences.analytics) {
        if (typeof gtag !== 'undefined') {
            gtag('consent', 'update', { 'analytics_storage': 'granted' });
        }
    } else {
        if (typeof gtag !== 'undefined') {
            gtag('consent', 'update', { 'analytics_storage': 'denied' });
        }
    }
    
    // Google AdSense
    if (preferences.advertising) {
        if (typeof gtag !== 'undefined') {
            gtag('consent', 'update', { 'ad_storage': 'granted' });
        }
    } else {
        if (typeof gtag !== 'undefined') {
            gtag('consent', 'update', { 'ad_storage': 'denied' });
        }
    }
}

function updateCookieStatus() {
    const consent = localStorage.getItem('cookieConsent');
    const preferences = JSON.parse(localStorage.getItem('cookiePreferences') || '{}');
    const statusDiv = document.getElementById('cookieStatus');
    
    if (consent === 'accepted') {
        statusDiv.innerHTML = '<span class="badge bg-success">Todos os cookies aceitos</span>';
    } else if (consent === 'customized') {
        const activeTypes = [];
        if (preferences.analytics) activeTypes.push('Analytics');
        if (preferences.advertising) activeTypes.push('Publicidade');
        if (preferences.functional) activeTypes.push('Funcionais');
        
        statusDiv.innerHTML = `<span class="badge bg-info">Personalizados: ${activeTypes.join(', ') || 'Apenas essenciais'}</span>`;
    } else if (consent === 'rejected') {
        statusDiv.innerHTML = '<span class="badge bg-warning">Apenas cookies essenciais</span>';
    } else {
        statusDiv.innerHTML = '<span class="badge bg-secondary">N√£o definido</span>';
    }
}
</script>
{% endblock %}