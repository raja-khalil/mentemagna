{% extends 'admin_base.html' %}

{% block title %}{{ legend }} - Admin{% endblock %}

{% block content %}
<div class="container">
    <div class="row">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h4 class="mb-0">{{ legend }}</h4>
                </div>
                <div class="card-body">
                    <form method="POST" enctype="multipart/form-data" novalidate>
                        {{ form.hidden_tag() }}
                        
                        <div class="mb-3">
                            {{ form.titulo.label(class="form-label") }}
                            {{ form.titulo(class="form-control form-control-lg") }}
                            {% if form.titulo.errors %}
                                <div class="text-danger">
                                    {% for error in form.titulo.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>

                        <div class="mb-3">
                            {{ form.resumo.label(class="form-label") }}
                            {{ form.resumo(class="form-control", rows="3") }}
                            <small class="form-text text-muted">
                                Este resumo ser치 usado para SEO e compartilhamentos. M치ximo 300 caracteres.
                            </small>
                            {% if form.resumo.errors %}
                                <div class="text-danger">
                                    {% for error in form.resumo.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="mb-3">
                            {{ form.conteudo.label(class="form-label") }}
                            {{ form.conteudo(class="form-control", rows="15", style="font-family: monospace;") }}
                            <small class="form-text text-muted">
                                Use HTML para formata칞칚o. Ex: &lt;h2&gt;T칤tulo&lt;/h2&gt;, &lt;p&gt;Par치grafo&lt;/p&gt;, &lt;strong&gt;Negrito&lt;/strong&gt;
                            </small>
                            {% if form.conteudo.errors %}
                                <div class="text-danger">
                                    {% for error in form.conteudo.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="mb-3">
                            {{ form.imagem.label(class="form-label") }}
                            {{ form.imagem(class="form-control") }}
                            {% if post and post.imagem %}
                                <small class="d-block mt-2">
                                    Imagem atual: 
                                    <img src="{{ post.imagem }}" alt="Imagem atual" style="max-width: 200px; height: auto;" class="rounded">
                                </small>
                            {% endif %}
                            {% if form.imagem.errors %}
                                <div class="text-danger">
                                    {% for error in form.imagem.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="mb-3 form-check">
                            {{ form.publicado(class="form-check-input") }}
                            {{ form.publicado.label(class="form-check-label") }}
                        </div>
                        
                        <div class="d-flex justify-content-between">
                            <div>
                                {{ form.submit(class="btn btn-primary btn-lg") }}
                                <a href="{{ url_for('admin.dashboard') }}" class="btn btn-secondary btn-lg">Cancelar</a>
                            </div>
                            {% if post %}
                                <button type="button" class="btn btn-danger btn-lg" data-bs-toggle="modal" data-bs-target="#deleteModal">
                                    Excluir Post
                                </button>
                            {% endif %}
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">游눠 Dicas de Formata칞칚o</h5>
                </div>
                <div class="card-body">
                    <small>
                        <strong>T칤tulos:</strong><br>
                        &lt;h2&gt;T칤tulo Principal&lt;/h2&gt;<br>
                        &lt;h3&gt;Subt칤tulo&lt;/h3&gt;<br><br>
                        
                        <strong>Par치grafos:</strong><br>
                        &lt;p&gt;Seu texto aqui&lt;/p&gt;<br><br>
                        
                        <strong>Formata칞칚o:</strong><br>
                        &lt;strong&gt;Negrito&lt;/strong&gt;<br>
                        &lt;em&gt;It치lico&lt;/em&gt;<br><br>
                        
                        <strong>Listas:</strong><br>
                        &lt;ul&gt;<br>
                        &nbsp;&nbsp;&lt;li&gt;Item 1&lt;/li&gt;<br>
                        &nbsp;&nbsp;&lt;li&gt;Item 2&lt;/li&gt;<br>
                        &lt;/ul&gt;<br><br>
                        
                        <strong>Links:</strong><br>
                        &lt;a href="URL"&gt;Texto do link&lt;/a&gt;<br><br>
                        
                        <strong>Imagens:</strong><br>
                        &lt;img src="URL" alt="Descri칞칚o"&gt;
                    </small>
                </div>
            </div>
        </div>
    </div>
</div>

{% if post %}
<!-- Modal de confirma칞칚o para deletar -->
<div class="modal fade" id="deleteModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">丘멆잺 Confirmar Exclus칚o</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p>Tem certeza que deseja deletar o post <strong>"{{ post.titulo }}"</strong>?</p>
                <p class="text-danger"><strong>Esta a칞칚o n칚o pode ser desfeita.</strong></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <form method="POST" action="{{ url_for('admin.deletar_post', post_id=post.id) }}" style="display: inline;">
                    <button type="submit" class="btn btn-danger">Deletar Definitivamente</button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}